<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlexAI Star Trek Agile System - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .lcars-gradient {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 25%, #ffd23f 50%, #06ffa5 75%, #00d4ff 100%);
        }
        .lcars-panel {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            border: 2px solid #ff6b35;
            border-radius: 15px;
        }
        .lcars-button {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .lcars-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Navigation -->
    <nav class="lcars-panel p-4 mb-8">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <i class="fas fa-rocket text-3xl text-orange-400"></i>
                <h1 class="text-2xl font-bold text-orange-400">AlexAI Star Trek Agile System</h1>
            </div>
            <div class="flex space-x-4">
                <a href="/" class="lcars-button px-6 py-2">Dashboard</a>
                <a href="/projects" class="lcars-button px-6 py-2">Projects</a>
                <a href="/observation-lounge" class="lcars-button px-6 py-2">Observation Lounge</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4">
        <!-- Welcome Section -->
        <div class="lcars-panel p-8 mb-8">
            <div class="text-center">
                <h2 class="text-4xl font-bold text-orange-400 mb-4">Welcome to the Bridge</h2>
                <p class="text-xl text-gray-300 mb-6">Multi-agent AI system ready for your command</p>
                <div class="flex justify-center space-x-4">
                    <button onclick="location.href='/projects'" class="lcars-button px-8 py-3 text-lg">
                        <i class="fas fa-project-diagram mr-2"></i>View Projects
                    </button>
                    <button onclick="location.href='/observation-lounge'" class="lcars-button px-8 py-3 text-lg">
                        <i class="fas fa-eye mr-2"></i>Observation Lounge
                    </button>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="lcars-panel p-6 text-center">
                <i class="fas fa-project-diagram text-4xl text-blue-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-blue-400" id="total-projects">-</h3>
                <p class="text-gray-300">Active Projects</p>
            </div>
            <div class="lcars-panel p-6 text-center">
                <i class="fas fa-tasks text-4xl text-green-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-green-400" id="active-tasks">-</h3>
                <p class="text-gray-300">Active Tasks</p>
            </div>
            <div class="lcars-panel p-6 text-center">
                <i class="fas fa-check-circle text-4xl text-purple-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-purple-400" id="completed-tasks">-</h3>
                <p class="text-gray-300">Completed Today</p>
            </div>
            <div class="lcars-panel p-6 text-center">
                <i class="fas fa-users text-4xl text-orange-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-orange-400" id="total-tasks">-</h3>
                <p class="text-gray-300">Total Tasks</p>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="lcars-panel p-6">
                <h3 class="text-2xl font-bold text-orange-400 mb-4">
                    <i class="fas fa-clock mr-2"></i>Recent Tasks
                </h3>
                <div id="recent-tasks" class="space-y-3">
                    <div class="text-center text-gray-400">
                        <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                        <p>Loading recent tasks...</p>
                    </div>
                </div>
            </div>

            <div class="lcars-panel p-6">
                <h3 class="text-2xl font-bold text-orange-400 mb-4">
                    <i class="fas fa-robot mr-2"></i>AlexAI Status
                </h3>
                <div id="alexai-status" class="space-y-3">
                    <div class="text-center text-gray-400">
                        <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                        <p>Loading AlexAI status...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Socket.IO
        const socket = io();

        // Load dashboard data
        async function loadDashboardData() {
            try {
                // Load stats
                const statsResponse = await fetch('/api/dashboard/stats');
                const statsData = await statsResponse.json();
                
                if (statsData.success) {
                    document.getElementById('total-projects').textContent = statsData.stats.total_projects;
                    document.getElementById('active-tasks').textContent = statsData.stats.active_tasks;
                    document.getElementById('completed-tasks').textContent = statsData.stats.completed_today;
                    document.getElementById('total-tasks').textContent = statsData.stats.total_tasks;
                }

                // Load recent tasks
                const tasksResponse = await fetch('/api/dashboard/recent-tasks');
                const tasksData = await tasksResponse.json();
                
                if (tasksData.success) {
                    const recentTasksContainer = document.getElementById('recent-tasks');
                    if (tasksData.tasks.length > 0) {
                        recentTasksContainer.innerHTML = tasksData.tasks.map(task => `
                            <div class="border-l-4 border-blue-400 pl-4 py-2">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-semibold text-blue-400">${task.title}</h4>
                                        <p class="text-sm text-gray-400">${task.project_name}</p>
                                    </div>
                                    <span class="px-2 py-1 text-xs rounded-full ${getStatusColor(task.status)}">
                                        ${task.status.replace('_', ' ')}
                                    </span>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        recentTasksContainer.innerHTML = '<p class="text-gray-400">No recent tasks</p>';
                    }
                }

                // Load AlexAI status
                const alexaiResponse = await fetch('/api/alexai/status');
                const alexaiData = await alexaiResponse.json();
                
                if (alexaiData.success) {
                    const alexaiContainer = document.getElementById('alexai-status');
                    const crewStatus = alexaiData.crew_status;
                    
                    alexaiContainer.innerHTML = `
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">System Health:</span>
                                <span class="text-green-400 font-semibold">${crewStatus.system_health.overall_status}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">Crew Coordination:</span>
                                <span class="text-blue-400 font-semibold">${crewStatus.system_health.crew_coordination}%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">Project Velocity:</span>
                                <span class="text-purple-400 font-semibold">${crewStatus.system_health.project_velocity}%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">Current Mode:</span>
                                <span class="text-orange-400 font-semibold">${crewStatus.current_mode}</span>
                            </div>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        function getStatusColor(status) {
            const colors = {
                'todo': 'bg-gray-100 text-gray-800',
                'in_progress': 'bg-blue-100 text-blue-800',
                'review': 'bg-purple-100 text-purple-800',
                'done': 'bg-green-100 text-green-800',
                'blocked': 'bg-red-100 text-red-800'
            };
            return colors[status] || 'bg-gray-100 text-gray-800';
        }

        // Socket.IO event handlers
        socket.on('connect', function() {
            console.log('Connected to AlexAI Agile Manager');
        });

        socket.on('task_updated', function(data) {
            console.log('Task updated:', data);
            // Reload recent tasks
            loadDashboardData();
        });

        socket.on('project_updated', function(data) {
            console.log('Project updated:', data);
            // Reload dashboard stats
            loadDashboardData();
        });

        // Load data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
        });
    </script>
</body>
</html> 