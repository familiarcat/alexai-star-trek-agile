<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCARS - AlexAI Star Trek Agile System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/lcars.css">
    <script src="/assets/data-translator.js"></script>
</head>
<body>
    <div class="lcars-container">
        <!-- LCARS Sidebar Menu -->
        <div class="lcars-sidebar">
            <div class="lcars-menu-header">
                LCARS MENU
            </div>
            
            <div class="lcars-menu-item active" onclick="location.href='/'">
                <i class="fas fa-tachometer-alt lcars-mr-10"></i>
                DASHBOARD
            </div>
            
            <div class="lcars-menu-item" onclick="location.href='/projects'">
                <i class="fas fa-project-diagram lcars-mr-10"></i>
                PROJECTS
            </div>
            
            <div class="lcars-menu-item" onclick="location.href='/observation-lounge'">
                <i class="fas fa-eye lcars-mr-10"></i>
                OBSERVATION LOUNGE
            </div>
            
            <div class="lcars-menu-item" onclick="location.href='/project-detail'">
                <i class="fas fa-tasks lcars-mr-10"></i>
                TASK MANAGER
            </div>
            
            <div class="lcars-menu-item" onclick="location.href='/alexai'">
                <i class="fas fa-robot lcars-mr-10"></i>
                ALEXAI CORE
            </div>
            
            <!-- LCARS Status Summary -->
            <div class="lcars-panel lcars-mt-10">
                <div class="lcars-text lcars-text-large lcars-text-gold lcars-mb-10">SYSTEM STATUS</div>
                
                <div class="lcars-status">
                    <div class="lcars-status-indicator"></div>
                    <span>SUBSPACE LINK: ESTABLISHED</span>
                </div>
                
                <div class="lcars-status">
                    <div class="lcars-status-indicator"></div>
                    <span>STARFLEET DATABASE: CONNECTED</span>
                </div>
                
                <div class="lcars-status">
                    <div class="lcars-status-indicator"></div>
                    <span>QUANTUM MEMORY FIELD: STABLE</span>
                </div>
                
                <div class="lcars-status">
                    <div class="lcars-status-indicator"></div>
                    <span>OPTICAL DATA NETWORK: ONLINE</span>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="lcars-main">
            <!-- Top Header Bar -->
            <div class="lcars-nav">
                <div class="lcars-nav-brand">
                    LCARS SYSTEM 3 - ALEXAI AGILE MANAGER
                </div>
                <div class="lcars-nav-menu">
                    <div class="lcars-button secondary" onclick="location.href='/api/health'">
                        <i class="fas fa-heartbeat lcars-mr-10"></i>
                        SYSTEM HEALTH
                    </div>
                    <div class="lcars-button secondary" onclick="location.href='/api/dashboard/stats'">
                        <i class="fas fa-chart-bar lcars-mr-10"></i>
                        STATISTICS
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Content -->
            <div class="lcars-fade-in">
                <!-- Welcome Section -->
                <div class="lcars-panel">
                    <div class="lcars-text lcars-text-xxlarge lcars-text-gold lcars-text-center lcars-mb-10">
                        WELCOME TO LCARS ULTRA
                    </div>
                    <div class="lcars-text lcars-text-large lcars-text-center lcars-mb-20">
                        ALEXAI STAR TREK AGILE SYSTEM • CLASSIC THEME
                    </div>
                    <div class="lcars-text lcars-text-center">
                        Multi-agent AI system ready for your command. All systems operational.
                    </div>
                </div>

                <!-- LCARS Data Grid -->
                <div class="lcars-data-grid">
                    <div class="lcars-data-item">
                        <div class="lcars-data-value" id="total-projects">-</div>
                        <div class="lcars-data-label">TOTAL PROJECTS</div>
                    </div>
                    
                    <div class="lcars-data-item">
                        <div class="lcars-data-value" id="active-tasks">-</div>
                        <div class="lcars-data-label">ACTIVE TASKS</div>
                    </div>
                    
                    <div class="lcars-data-item">
                        <div class="lcars-data-value" id="completed-tasks">-</div>
                        <div class="lcars-data-label">COMPLETED TODAY</div>
                    </div>
                    
                    <div class="lcars-data-item">
                        <div class="lcars-data-value" id="total-tasks">-</div>
                        <div class="lcars-data-label">TOTAL TASKS</div>
                    </div>
                </div>

                <!-- System Performance Section -->
                <div class="lcars-panel">
                    <div class="lcars-text lcars-text-xlarge lcars-text-gold lcars-mb-15">
                        <i class="fas fa-microchip lcars-mr-10"></i>
                        SYSTEM PERFORMANCE METRICS
                    </div>
                    
                    <div class="lcars-l-shape">
                        <i class="fas fa-cpu lcars-mr-10"></i>
                        CPU UTILIZATION: <span id="cpu-usage">--</span>%
                    </div>
                    
                    <div class="lcars-l-shape">
                        <i class="fas fa-memory lcars-mr-10"></i>
                        MEMORY USAGE: <span id="memory-usage">--</span>%
                    </div>
                    
                    <div class="lcars-l-shape">
                        <i class="fas fa-database lcars-mr-10"></i>
                        DATABASE STATUS: <span id="db-status">ONLINE</span>
                    </div>
                    
                    <div class="lcars-l-shape">
                        <i class="fas fa-network-wired lcars-mr-10"></i>
                        NETWORK LATENCY: <span id="network-latency">--</span>ms
                    </div>
                </div>

                <!-- Recent Activity and AlexAI Status -->
                <div class="lcars-data-grid">
                    <!-- Recent Tasks -->
                    <div class="lcars-panel">
                        <div class="lcars-text lcars-text-xlarge lcars-text-gold lcars-mb-15">
                            <i class="fas fa-clock lcars-mr-10"></i>
                            RECENT TASKS
                        </div>
                        <div id="recent-tasks" class="lcars-text">
                            <div class="lcars-text-center lcars-text-grey">
                                <i class="fas fa-spinner fa-spin lcars-mr-10"></i>
                                Loading recent tasks...
                            </div>
                        </div>
                    </div>

                    <!-- AlexAI Status -->
                    <div class="lcars-panel">
                        <div class="lcars-text lcars-text-xlarge lcars-text-gold lcars-mb-15">
                            <i class="fas fa-robot lcars-mr-10"></i>
                            ALEXAI CORE STATUS
                        </div>
                        <div id="alexai-status" class="lcars-text">
                            <div class="lcars-text-center lcars-text-grey">
                                <i class="fas fa-spinner fa-spin lcars-mr-10"></i>
                                Loading AlexAI status...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="lcars-panel">
                    <div class="lcars-text lcars-text-xlarge lcars-text-gold lcars-mb-15">
                        <i class="fas fa-rocket lcars-mr-10"></i>
                        QUICK ACTIONS
                    </div>
                    
                    <div class="lcars-data-grid">
                        <div class="lcars-button lcars-text-large" onclick="location.href='/projects'">
                            <i class="fas fa-project-diagram lcars-mr-10"></i>
                            VIEW PROJECTS
                        </div>
                        
                        <div class="lcars-button lcars-text-large" onclick="location.href='/observation-lounge'">
                            <i class="fas fa-eye lcars-mr-10"></i>
                            OBSERVATION LOUNGE
                        </div>
                        
                        <div class="lcars-button lcars-text-large" onclick="dataTranslator.createMockData().then(() => loadDashboardData())">
                            <i class="fas fa-database lcars-mr-10"></i>
                            INITIALIZE MOCK DATA
                        </div>
                        
                        <div class="lcars-button lcars-text-large" onclick="location.href='/api/health'">
                            <i class="fas fa-heartbeat lcars-mr-10"></i>
                            SYSTEM DIAGNOSTICS
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Load dashboard data using unified data translator
        async function loadDashboardData() {
            try {
                // Load dashboard stats
                const stats = await dataTranslator.getDashboardStats();
                
                // Update metrics
                document.getElementById('total-projects').textContent = stats.total_projects;
                document.getElementById('active-tasks').textContent = stats.active_tasks;
                document.getElementById('completed-tasks').textContent = stats.completed_today;
                document.getElementById('total-tasks').textContent = stats.total_tasks;

                // Load recent tasks
                const tasks = await dataTranslator.getTasks();
                const recentTasksContainer = document.getElementById('recent-tasks');
                
                if (tasks.length > 0) {
                    recentTasksContainer.innerHTML = tasks.slice(0, 5).map(task => `
                        <div class="lcars-status ${getStatusClass(task.status)}">
                            <div class="lcars-status-indicator"></div>
                            <div>
                                <div class="lcars-text-gold">${dataTranslator.escapeHtml(task.title)}</div>
                                <div class="lcars-text-grey">${task.assignee} • ${task.status.replace('_', ' ')}</div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    recentTasksContainer.innerHTML = '<div class="lcars-text-center lcars-text-grey">No recent tasks</div>';
                }

                // Load AlexAI status
                const alexaiData = await dataTranslator.getAlexAIStatus();
                const alexaiContainer = document.getElementById('alexai-status');
                
                alexaiContainer.innerHTML = `
                    <div class="lcars-status">
                        <div class="lcars-status-indicator"></div>
                        <span>SYSTEM HEALTH: ${alexaiData.system_health.overall_status || 'OPTIMAL'}</span>
                    </div>
                    <div class="lcars-status">
                        <div class="lcars-status-indicator"></div>
                        <span>CREW COORDINATION: ${alexaiData.system_health.crew_coordination || 95}%</span>
                    </div>
                    <div class="lcars-status">
                        <div class="lcars-status-indicator"></div>
                        <span>PROJECT VELOCITY: ${alexaiData.system_health.project_velocity || 87}%</span>
                    </div>
                    <div class="lcars-status">
                        <div class="lcars-status-indicator"></div>
                        <span>CURRENT MODE: ${alexaiData.current_mode}</span>
                    </div>
                `;

                // Update system metrics
                updateSystemMetrics();

            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        function getStatusClass(status) {
            const statusMap = {
                'todo': '',
                'in_progress': 'warning',
                'review': 'warning',
                'done': '',
                'blocked': 'error'
            };
            return statusMap[status] || '';
        }

        function updateSystemMetrics() {
            // Simulate system metrics
            document.getElementById('cpu-usage').textContent = Math.floor(Math.random() * 30) + 10;
            document.getElementById('memory-usage').textContent = Math.floor(Math.random() * 40) + 20;
            document.getElementById('network-latency').textContent = Math.floor(Math.random() * 50) + 5;
        }

        // Subscribe to real-time updates
        dataTranslator.subscribe('dashboard', (data) => {
            console.log('Dashboard updated:', data);
            loadDashboardData();
        });

        dataTranslator.subscribe('tasks', (data) => {
            console.log('Tasks updated:', data);
            loadDashboardData();
        });

        // Load data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
            
            // Update system metrics every 30 seconds
            setInterval(updateSystemMetrics, 30000);
        });
    </script>
</body>
</html> 